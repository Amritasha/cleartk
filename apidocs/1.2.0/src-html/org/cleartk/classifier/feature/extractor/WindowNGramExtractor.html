<HTML>
<BODY BGCOLOR="white">
<PRE>
<FONT color="green">001</FONT>    /** <a name="line.1"></a>
<FONT color="green">002</FONT>     * Copyright (c) 2007-2008, Regents of the University of Colorado <a name="line.2"></a>
<FONT color="green">003</FONT>     * All rights reserved.<a name="line.3"></a>
<FONT color="green">004</FONT>     * <a name="line.4"></a>
<FONT color="green">005</FONT>     * Redistribution and use in source and binary forms, with or without<a name="line.5"></a>
<FONT color="green">006</FONT>     * modification, are permitted provided that the following conditions are met:<a name="line.6"></a>
<FONT color="green">007</FONT>     * <a name="line.7"></a>
<FONT color="green">008</FONT>     * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. <a name="line.8"></a>
<FONT color="green">009</FONT>     * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. <a name="line.9"></a>
<FONT color="green">010</FONT>     * Neither the name of the University of Colorado at Boulder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. <a name="line.10"></a>
<FONT color="green">011</FONT>     * <a name="line.11"></a>
<FONT color="green">012</FONT>     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"<a name="line.12"></a>
<FONT color="green">013</FONT>     * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<a name="line.13"></a>
<FONT color="green">014</FONT>     * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<a name="line.14"></a>
<FONT color="green">015</FONT>     * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE<a name="line.15"></a>
<FONT color="green">016</FONT>     * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR<a name="line.16"></a>
<FONT color="green">017</FONT>     * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF<a name="line.17"></a>
<FONT color="green">018</FONT>     * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS<a name="line.18"></a>
<FONT color="green">019</FONT>     * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN<a name="line.19"></a>
<FONT color="green">020</FONT>     * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)<a name="line.20"></a>
<FONT color="green">021</FONT>     * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE<a name="line.21"></a>
<FONT color="green">022</FONT>     * POSSIBILITY OF SUCH DAMAGE. <a name="line.22"></a>
<FONT color="green">023</FONT>     */<a name="line.23"></a>
<FONT color="green">024</FONT>    package org.cleartk.classifier.feature.extractor;<a name="line.24"></a>
<FONT color="green">025</FONT>    <a name="line.25"></a>
<FONT color="green">026</FONT>    import java.util.ArrayList;<a name="line.26"></a>
<FONT color="green">027</FONT>    import java.util.List;<a name="line.27"></a>
<FONT color="green">028</FONT>    <a name="line.28"></a>
<FONT color="green">029</FONT>    import org.apache.uima.cas.FSIterator;<a name="line.29"></a>
<FONT color="green">030</FONT>    import org.apache.uima.cas.Type;<a name="line.30"></a>
<FONT color="green">031</FONT>    import org.apache.uima.jcas.JCas;<a name="line.31"></a>
<FONT color="green">032</FONT>    import org.apache.uima.jcas.tcas.Annotation;<a name="line.32"></a>
<FONT color="green">033</FONT>    import org.cleartk.classifier.Feature;<a name="line.33"></a>
<FONT color="green">034</FONT>    import org.cleartk.classifier.feature.WindowFeature;<a name="line.34"></a>
<FONT color="green">035</FONT>    import org.cleartk.classifier.feature.WindowNGramFeature;<a name="line.35"></a>
<FONT color="green">036</FONT>    import org.cleartk.classifier.feature.extractor.simple.SimpleFeatureExtractor;<a name="line.36"></a>
<FONT color="green">037</FONT>    import org.cleartk.util.AnnotationUtil;<a name="line.37"></a>
<FONT color="green">038</FONT>    import org.cleartk.util.UIMAUtil;<a name="line.38"></a>
<FONT color="green">039</FONT>    import org.uimafit.util.JCasUtil;<a name="line.39"></a>
<FONT color="green">040</FONT>    <a name="line.40"></a>
<FONT color="green">041</FONT>    /**<a name="line.41"></a>
<FONT color="green">042</FONT>     * &lt;br&gt;<a name="line.42"></a>
<FONT color="green">043</FONT>     * Copyright (c) 2007-2008, Regents of the University of Colorado &lt;br&gt;<a name="line.43"></a>
<FONT color="green">044</FONT>     * All rights reserved.<a name="line.44"></a>
<FONT color="green">045</FONT>     * <a name="line.45"></a>
<FONT color="green">046</FONT>     * &lt;p&gt;<a name="line.46"></a>
<FONT color="green">047</FONT>     * <a name="line.47"></a>
<FONT color="green">048</FONT>     * @deprecated Use {@link CleartkExtractor} instead.<a name="line.48"></a>
<FONT color="green">049</FONT>     * @author Philip Ogren<a name="line.49"></a>
<FONT color="green">050</FONT>     * <a name="line.50"></a>
<FONT color="green">051</FONT>     *         This class may change significantly per issue 19 as described here:<a name="line.51"></a>
<FONT color="green">052</FONT>     *         http://code.google.com/p/cleartk/issues/detail?id=19<a name="line.52"></a>
<FONT color="green">053</FONT>     *         &lt;p&gt;<a name="line.53"></a>
<FONT color="green">054</FONT>     *         This class is very similar to the WindowExtractor in the ClearTK project, except that<a name="line.54"></a>
<FONT color="green">055</FONT>     *         instead of getting individual features for each index in the window (as WindowExtractor<a name="line.55"></a>
<FONT color="green">056</FONT>     *         does) it creates a single feature that represents an n-gram for all the indexes in the<a name="line.56"></a>
<FONT color="green">057</FONT>     *         window. As an example, a window extractor that obtains the three words to the left of a<a name="line.57"></a>
<FONT color="green">058</FONT>     *         focus word would retrieve three annotations following sentence for the word "in": &lt;br&gt;<a name="line.58"></a>
<FONT color="green">059</FONT>     *         The blue chair in the corner &lt;br&gt;<a name="line.59"></a>
<FONT color="green">060</FONT>     *         The three features would be "The (left 3)", "blue (left 2)", "chair (left 1)". The ngram<a name="line.60"></a>
<FONT color="green">061</FONT>     *         extractor would retrieve a single feature "The blue chair" - which is the 3-gram<a name="line.61"></a>
<FONT color="green">062</FONT>     *         preceding "in".<a name="line.62"></a>
<FONT color="green">063</FONT>     *         &lt;p&gt;<a name="line.63"></a>
<FONT color="green">064</FONT>     *         This extractor has a vastly different purpose than the CharacterNGramProliferator which<a name="line.64"></a>
<FONT color="green">065</FONT>     *         is used to take string features and create prefix/suffix features.<a name="line.65"></a>
<FONT color="green">066</FONT>     */<a name="line.66"></a>
<FONT color="green">067</FONT>    <a name="line.67"></a>
<FONT color="green">068</FONT>    @Deprecated<a name="line.68"></a>
<FONT color="green">069</FONT>    public class WindowNGramExtractor {<a name="line.69"></a>
<FONT color="green">070</FONT>    <a name="line.70"></a>
<FONT color="green">071</FONT>      Class&lt;? extends Annotation&gt; featureClass;<a name="line.71"></a>
<FONT color="green">072</FONT>    <a name="line.72"></a>
<FONT color="green">073</FONT>      Type featureType;<a name="line.73"></a>
<FONT color="green">074</FONT>    <a name="line.74"></a>
<FONT color="green">075</FONT>      SimpleFeatureExtractor featureExtractor;<a name="line.75"></a>
<FONT color="green">076</FONT>    <a name="line.76"></a>
<FONT color="green">077</FONT>      String orientation;<a name="line.77"></a>
<FONT color="green">078</FONT>    <a name="line.78"></a>
<FONT color="green">079</FONT>      String direction;<a name="line.79"></a>
<FONT color="green">080</FONT>    <a name="line.80"></a>
<FONT color="green">081</FONT>      String separator;<a name="line.81"></a>
<FONT color="green">082</FONT>    <a name="line.82"></a>
<FONT color="green">083</FONT>      int start;<a name="line.83"></a>
<FONT color="green">084</FONT>    <a name="line.84"></a>
<FONT color="green">085</FONT>      int end;<a name="line.85"></a>
<FONT color="green">086</FONT>    <a name="line.86"></a>
<FONT color="green">087</FONT>      protected String name;<a name="line.87"></a>
<FONT color="green">088</FONT>    <a name="line.88"></a>
<FONT color="green">089</FONT>      public WindowNGramExtractor(<a name="line.89"></a>
<FONT color="green">090</FONT>          Class&lt;? extends Annotation&gt; featureClass,<a name="line.90"></a>
<FONT color="green">091</FONT>          SimpleFeatureExtractor featureExtractor,<a name="line.91"></a>
<FONT color="green">092</FONT>          String ngramOrientation,<a name="line.92"></a>
<FONT color="green">093</FONT>          String ngramDirection,<a name="line.93"></a>
<FONT color="green">094</FONT>          String ngramSeparator,<a name="line.94"></a>
<FONT color="green">095</FONT>          int ngramStart,<a name="line.95"></a>
<FONT color="green">096</FONT>          int ngramEnd) {<a name="line.96"></a>
<FONT color="green">097</FONT>        this.featureClass = featureClass;<a name="line.97"></a>
<FONT color="green">098</FONT>        this.featureExtractor = featureExtractor;<a name="line.98"></a>
<FONT color="green">099</FONT>        this.orientation = ngramOrientation;<a name="line.99"></a>
<FONT color="green">100</FONT>        this.direction = ngramDirection;<a name="line.100"></a>
<FONT color="green">101</FONT>        this.separator = ngramSeparator;<a name="line.101"></a>
<FONT color="green">102</FONT>        this.start = ngramStart;<a name="line.102"></a>
<FONT color="green">103</FONT>        this.end = ngramEnd;<a name="line.103"></a>
<FONT color="green">104</FONT>      }<a name="line.104"></a>
<FONT color="green">105</FONT>    <a name="line.105"></a>
<FONT color="green">106</FONT>      /**<a name="line.106"></a>
<FONT color="green">107</FONT>       * This feature extractor provides a mechanism for getting features such as:<a name="line.107"></a>
<FONT color="green">108</FONT>       * &lt;ul&gt;<a name="line.108"></a>
<FONT color="green">109</FONT>       * &lt;li&gt;the word trigram to the left or right of a token.&lt;/li&gt;<a name="line.109"></a>
<FONT color="green">110</FONT>       * &lt;li&gt;get word trigram to the left and right of a constituent bounded by a sentence.&lt;/li&gt;<a name="line.110"></a>
<FONT color="green">111</FONT>       * &lt;li&gt;get the n-grams "inside" a constituent&lt;/li&gt;<a name="line.111"></a>
<FONT color="green">112</FONT>       * &lt;li&gt;the pos tag trigram of the three words to the left of a token&lt;/li&gt;<a name="line.112"></a>
<FONT color="green">113</FONT>       * &lt;/ul&gt;<a name="line.113"></a>
<FONT color="green">114</FONT>       * <a name="line.114"></a>
<FONT color="green">115</FONT>       * @param name<a name="line.115"></a>
<FONT color="green">116</FONT>       *          the name of the extractor<a name="line.116"></a>
<FONT color="green">117</FONT>       * @param featureClass<a name="line.117"></a>
<FONT color="green">118</FONT>       *          the type of the annotations that we are going to extract a feature from<a name="line.118"></a>
<FONT color="green">119</FONT>       * @param featureExtractor<a name="line.119"></a>
<FONT color="green">120</FONT>       *          a feature extractor that will extract features from the annotations of type<a name="line.120"></a>
<FONT color="green">121</FONT>       *          featureType<a name="line.121"></a>
<FONT color="green">122</FONT>       * @param ngramOrientation<a name="line.122"></a>
<FONT color="green">123</FONT>       *          one of ORIENTATION_LEFT, ORIENTATION_RIGHT, ORIENTATION_MIDDLE,<a name="line.123"></a>
<FONT color="green">124</FONT>       *          ORIENTATION_MIDDLE_REVERSE<a name="line.124"></a>
<FONT color="green">125</FONT>       * @param ngramStart<a name="line.125"></a>
<FONT color="green">126</FONT>       *          the index (inclusive) of the first annotation of type featureType to examine<a name="line.126"></a>
<FONT color="green">127</FONT>       * @param ngramEnd<a name="line.127"></a>
<FONT color="green">128</FONT>       *          the index (exclusive) of the last annotation to examine.<a name="line.128"></a>
<FONT color="green">129</FONT>       * <a name="line.129"></a>
<FONT color="green">130</FONT>       * @see WindowNGramFeature<a name="line.130"></a>
<FONT color="green">131</FONT>       * <a name="line.131"></a>
<FONT color="green">132</FONT>       */<a name="line.132"></a>
<FONT color="green">133</FONT>      public WindowNGramExtractor(<a name="line.133"></a>
<FONT color="green">134</FONT>          String name,<a name="line.134"></a>
<FONT color="green">135</FONT>          Class&lt;? extends Annotation&gt; featureClass,<a name="line.135"></a>
<FONT color="green">136</FONT>          SimpleFeatureExtractor featureExtractor,<a name="line.136"></a>
<FONT color="green">137</FONT>          String ngramOrientation,<a name="line.137"></a>
<FONT color="green">138</FONT>          String ngramDirection,<a name="line.138"></a>
<FONT color="green">139</FONT>          String ngramSeparator,<a name="line.139"></a>
<FONT color="green">140</FONT>          int ngramStart,<a name="line.140"></a>
<FONT color="green">141</FONT>          int ngramEnd) {<a name="line.141"></a>
<FONT color="green">142</FONT>        this(<a name="line.142"></a>
<FONT color="green">143</FONT>            featureClass,<a name="line.143"></a>
<FONT color="green">144</FONT>            featureExtractor,<a name="line.144"></a>
<FONT color="green">145</FONT>            ngramOrientation,<a name="line.145"></a>
<FONT color="green">146</FONT>            ngramDirection,<a name="line.146"></a>
<FONT color="green">147</FONT>            ngramSeparator,<a name="line.147"></a>
<FONT color="green">148</FONT>            ngramStart,<a name="line.148"></a>
<FONT color="green">149</FONT>            ngramEnd);<a name="line.149"></a>
<FONT color="green">150</FONT>        this.name = name;<a name="line.150"></a>
<FONT color="green">151</FONT>      }<a name="line.151"></a>
<FONT color="green">152</FONT>    <a name="line.152"></a>
<FONT color="green">153</FONT>      /**<a name="line.153"></a>
<FONT color="green">154</FONT>       * VERY SLOW! DO NOT USE!<a name="line.154"></a>
<FONT color="green">155</FONT>       */<a name="line.155"></a>
<FONT color="green">156</FONT>      public Feature extract(JCas jCas, Annotation focusAnnotation, Class&lt;? extends Annotation&gt; cls)<a name="line.156"></a>
<FONT color="green">157</FONT>          throws CleartkExtractorException {<a name="line.157"></a>
<FONT color="green">158</FONT>        int annBegin = focusAnnotation.getBegin();<a name="line.158"></a>
<FONT color="green">159</FONT>        int annEnd = focusAnnotation.getEnd();<a name="line.159"></a>
<FONT color="green">160</FONT>        List&lt;? extends Annotation&gt; covering = JCasUtil.selectCovering(jCas, cls, annBegin, annEnd);<a name="line.160"></a>
<FONT color="green">161</FONT>        Annotation ngramAnnotation = covering.size() &gt; 0 ? covering.get(0) : null;<a name="line.161"></a>
<FONT color="green">162</FONT>        return extract(jCas, focusAnnotation, ngramAnnotation);<a name="line.162"></a>
<FONT color="green">163</FONT>      }<a name="line.163"></a>
<FONT color="green">164</FONT>    <a name="line.164"></a>
<FONT color="green">165</FONT>      public Feature extract(JCas jCas, Annotation focusAnnotation, Annotation ngramAnnotation)<a name="line.165"></a>
<FONT color="green">166</FONT>          throws CleartkExtractorException {<a name="line.166"></a>
<FONT color="green">167</FONT>        if (this.featureType == null)<a name="line.167"></a>
<FONT color="green">168</FONT>          this.featureType = UIMAUtil.getCasType(jCas, this.featureClass);<a name="line.168"></a>
<FONT color="green">169</FONT>    <a name="line.169"></a>
<FONT color="green">170</FONT>        List&lt;String&gt; ngramValues = new ArrayList&lt;String&gt;();<a name="line.170"></a>
<FONT color="green">171</FONT>    <a name="line.171"></a>
<FONT color="green">172</FONT>        Annotation startAnnotation = getStartAnnotation(jCas, focusAnnotation);<a name="line.172"></a>
<FONT color="green">173</FONT>    <a name="line.173"></a>
<FONT color="green">174</FONT>        FSIterator&lt;Annotation&gt; featureAnnotationIterator = jCas.getAnnotationIndex(featureType).iterator();<a name="line.174"></a>
<FONT color="green">175</FONT>    <a name="line.175"></a>
<FONT color="green">176</FONT>        if (startAnnotation != null) {<a name="line.176"></a>
<FONT color="green">177</FONT>          featureAnnotationIterator.moveTo(startAnnotation);<a name="line.177"></a>
<FONT color="green">178</FONT>        }<a name="line.178"></a>
<FONT color="green">179</FONT>    <a name="line.179"></a>
<FONT color="green">180</FONT>        int outOfBoundsDistance = 0;<a name="line.180"></a>
<FONT color="green">181</FONT>    <a name="line.181"></a>
<FONT color="green">182</FONT>        List&lt;Feature&gt; windowedFeatures = new ArrayList&lt;Feature&gt;();<a name="line.182"></a>
<FONT color="green">183</FONT>        for (int i = 0; i &lt; end; i++) {<a name="line.183"></a>
<FONT color="green">184</FONT>          // if start annotation is null, then we will mistakenly create a<a name="line.184"></a>
<FONT color="green">185</FONT>          // featureAnnotation for whatever<a name="line.185"></a>
<FONT color="green">186</FONT>          // annotation the iterator starts at. Therefore, we check for null<a name="line.186"></a>
<FONT color="green">187</FONT>          // here.<a name="line.187"></a>
<FONT color="green">188</FONT>          if (outOfBoundsDistance == 0 &amp;&amp; startAnnotation != null<a name="line.188"></a>
<FONT color="green">189</FONT>              &amp;&amp; featureAnnotationIterator.isValid()) {<a name="line.189"></a>
<FONT color="green">190</FONT>            Annotation featureAnnotation = featureAnnotationIterator.get();<a name="line.190"></a>
<FONT color="green">191</FONT>            if (isWithinBoundaries(featureAnnotation, focusAnnotation, ngramAnnotation)) {<a name="line.191"></a>
<FONT color="green">192</FONT>              if (i &gt;= start) {<a name="line.192"></a>
<FONT color="green">193</FONT>                Feature ngrammedFeature = extactNGrammedFeature(jCas, i, featureAnnotation);<a name="line.193"></a>
<FONT color="green">194</FONT>                if (ngrammedFeature != null) {<a name="line.194"></a>
<FONT color="green">195</FONT>                  ngramValues.add(ngrammedFeature.getValue().toString());<a name="line.195"></a>
<FONT color="green">196</FONT>                  windowedFeatures.add(ngrammedFeature);<a name="line.196"></a>
<FONT color="green">197</FONT>                } else<a name="line.197"></a>
<FONT color="green">198</FONT>                  ngramValues.add("NULL");<a name="line.198"></a>
<FONT color="green">199</FONT>    <a name="line.199"></a>
<FONT color="green">200</FONT>              }<a name="line.200"></a>
<FONT color="green">201</FONT>              moveIterator(featureAnnotationIterator);<a name="line.201"></a>
<FONT color="green">202</FONT>              continue;<a name="line.202"></a>
<FONT color="green">203</FONT>            }<a name="line.203"></a>
<FONT color="green">204</FONT>          }<a name="line.204"></a>
<FONT color="green">205</FONT>          outOfBoundsDistance++;<a name="line.205"></a>
<FONT color="green">206</FONT>          if (i &gt;= start) {<a name="line.206"></a>
<FONT color="green">207</FONT>            ngramValues.add("OOB" + outOfBoundsDistance);<a name="line.207"></a>
<FONT color="green">208</FONT>          }<a name="line.208"></a>
<FONT color="green">209</FONT>        }<a name="line.209"></a>
<FONT color="green">210</FONT>    <a name="line.210"></a>
<FONT color="green">211</FONT>        StringBuffer featureValue = new StringBuffer();<a name="line.211"></a>
<FONT color="green">212</FONT>        if ((direction.equals(WindowNGramFeature.DIRECTION_LEFT_TO_RIGHT) &amp;&amp; orientation.equals(WindowNGramFeature.ORIENTATION_RIGHT))<a name="line.212"></a>
<FONT color="green">213</FONT>            || (direction.equals(WindowNGramFeature.DIRECTION_RIGHT_TO_LEFT) &amp;&amp; orientation.equals(WindowNGramFeature.ORIENTATION_LEFT))) {<a name="line.213"></a>
<FONT color="green">214</FONT>          for (int i = 0; i &lt; ngramValues.size(); i++) {<a name="line.214"></a>
<FONT color="green">215</FONT>            featureValue.append(ngramValues.get(i));<a name="line.215"></a>
<FONT color="green">216</FONT>            if (i &lt; ngramValues.size() - 1)<a name="line.216"></a>
<FONT color="green">217</FONT>              featureValue.append(separator);<a name="line.217"></a>
<FONT color="green">218</FONT>          }<a name="line.218"></a>
<FONT color="green">219</FONT>        } else if ((direction.equals(WindowNGramFeature.DIRECTION_RIGHT_TO_LEFT) &amp;&amp; orientation.equals(WindowNGramFeature.ORIENTATION_RIGHT))<a name="line.219"></a>
<FONT color="green">220</FONT>            || (direction.equals(WindowNGramFeature.DIRECTION_LEFT_TO_RIGHT) &amp;&amp; orientation.equals(WindowNGramFeature.ORIENTATION_LEFT))) {<a name="line.220"></a>
<FONT color="green">221</FONT>          for (int i = ngramValues.size() - 1; i &gt;= 0; i--) {<a name="line.221"></a>
<FONT color="green">222</FONT>            featureValue.append(ngramValues.get(i));<a name="line.222"></a>
<FONT color="green">223</FONT>            if (i &gt; 0)<a name="line.223"></a>
<FONT color="green">224</FONT>              featureValue.append(separator);<a name="line.224"></a>
<FONT color="green">225</FONT>          }<a name="line.225"></a>
<FONT color="green">226</FONT>        }<a name="line.226"></a>
<FONT color="green">227</FONT>        WindowNGramFeature windowNGramFeature = new WindowNGramFeature(<a name="line.227"></a>
<FONT color="green">228</FONT>            null,<a name="line.228"></a>
<FONT color="green">229</FONT>            featureValue.toString(),<a name="line.229"></a>
<FONT color="green">230</FONT>            orientation,<a name="line.230"></a>
<FONT color="green">231</FONT>            direction,<a name="line.231"></a>
<FONT color="green">232</FONT>            separator,<a name="line.232"></a>
<FONT color="green">233</FONT>            end - start,<a name="line.233"></a>
<FONT color="green">234</FONT>            start,<a name="line.234"></a>
<FONT color="green">235</FONT>            windowedFeatures);<a name="line.235"></a>
<FONT color="green">236</FONT>        return windowNGramFeature;<a name="line.236"></a>
<FONT color="green">237</FONT>      }<a name="line.237"></a>
<FONT color="green">238</FONT>    <a name="line.238"></a>
<FONT color="green">239</FONT>      private boolean isWithinBoundaries(<a name="line.239"></a>
<FONT color="green">240</FONT>          Annotation featureAnnotation,<a name="line.240"></a>
<FONT color="green">241</FONT>          Annotation focusAnnotation,<a name="line.241"></a>
<FONT color="green">242</FONT>          Annotation ngramAnnotation) {<a name="line.242"></a>
<FONT color="green">243</FONT>        if (orientation.equals(WindowNGramFeature.ORIENTATION_LEFT)<a name="line.243"></a>
<FONT color="green">244</FONT>            || orientation.equals(WindowNGramFeature.ORIENTATION_RIGHT)) {<a name="line.244"></a>
<FONT color="green">245</FONT>          return AnnotationUtil.contains(ngramAnnotation, featureAnnotation);<a name="line.245"></a>
<FONT color="green">246</FONT>        } else<a name="line.246"></a>
<FONT color="green">247</FONT>          return AnnotationUtil.contains(ngramAnnotation, featureAnnotation)<a name="line.247"></a>
<FONT color="green">248</FONT>              &amp;&amp; AnnotationUtil.contains(focusAnnotation, featureAnnotation);<a name="line.248"></a>
<FONT color="green">249</FONT>      }<a name="line.249"></a>
<FONT color="green">250</FONT>    <a name="line.250"></a>
<FONT color="green">251</FONT>      private void moveIterator(FSIterator&lt;Annotation&gt; ngramIterator) {<a name="line.251"></a>
<FONT color="green">252</FONT>        if (orientation.equals(WindowNGramFeature.ORIENTATION_LEFT)<a name="line.252"></a>
<FONT color="green">253</FONT>            || orientation.equals(WindowNGramFeature.ORIENTATION_MIDDLE_REVERSE))<a name="line.253"></a>
<FONT color="green">254</FONT>          ngramIterator.moveToPrevious();<a name="line.254"></a>
<FONT color="green">255</FONT>        else if (orientation.equals(WindowNGramFeature.ORIENTATION_RIGHT)<a name="line.255"></a>
<FONT color="green">256</FONT>            || orientation.equals(WindowNGramFeature.ORIENTATION_MIDDLE))<a name="line.256"></a>
<FONT color="green">257</FONT>          ngramIterator.moveToNext();<a name="line.257"></a>
<FONT color="green">258</FONT>      }<a name="line.258"></a>
<FONT color="green">259</FONT>    <a name="line.259"></a>
<FONT color="green">260</FONT>      private Feature extactNGrammedFeature(JCas jCas, int i, Annotation annotation)<a name="line.260"></a>
<FONT color="green">261</FONT>          throws CleartkExtractorException {<a name="line.261"></a>
<FONT color="green">262</FONT>        List&lt;Feature&gt; ngramedFeatures = featureExtractor.extract(jCas, annotation);<a name="line.262"></a>
<FONT color="green">263</FONT>    <a name="line.263"></a>
<FONT color="green">264</FONT>        if (ngramedFeatures != null &amp;&amp; ngramedFeatures.size() &gt; 0) {<a name="line.264"></a>
<FONT color="green">265</FONT>          return ngramedFeatures.get(0);<a name="line.265"></a>
<FONT color="green">266</FONT>        }<a name="line.266"></a>
<FONT color="green">267</FONT>        return null;<a name="line.267"></a>
<FONT color="green">268</FONT>      }<a name="line.268"></a>
<FONT color="green">269</FONT>    <a name="line.269"></a>
<FONT color="green">270</FONT>      /**<a name="line.270"></a>
<FONT color="green">271</FONT>       * This method returns the annotation at index 0 w.r.t. the orientation of the extractor, the<a name="line.271"></a>
<FONT color="green">272</FONT>       * annotation we are extracting features for and the ngram the provides the boundaries for feature<a name="line.272"></a>
<FONT color="green">273</FONT>       * extraction.<a name="line.273"></a>
<FONT color="green">274</FONT>       * <a name="line.274"></a>
<FONT color="green">275</FONT>       * @param annotation<a name="line.275"></a>
<FONT color="green">276</FONT>       *          the annotation of focus for which we are extracting features for<a name="line.276"></a>
<FONT color="green">277</FONT>       * @return the annotation at index 0:<a name="line.277"></a>
<FONT color="green">278</FONT>       *         &lt;ul&gt;<a name="line.278"></a>
<FONT color="green">279</FONT>       *         &lt;li&gt;for ORIENTATION_LEFT return the annotation adjacent and to the left of annotation<a name="line.279"></a>
<FONT color="green">280</FONT>       *         &lt;li&gt;for ORIENTATION_RIGHT return the annotation adjacent and to the right of annotation<a name="line.280"></a>
<FONT color="green">281</FONT>       *         &lt;li&gt;for ORIENTATION_MIDDLE return the left most annotation completely contained in<a name="line.281"></a>
<FONT color="green">282</FONT>       *         annotation, null if does not exist<a name="line.282"></a>
<FONT color="green">283</FONT>       *         &lt;li&gt;for ORIENTATION_MIDDLE_REVERSE return the right most annotation completely<a name="line.283"></a>
<FONT color="green">284</FONT>       *         contained in annotation, null if does not exist<a name="line.284"></a>
<FONT color="green">285</FONT>       *         &lt;/ul&gt;<a name="line.285"></a>
<FONT color="green">286</FONT>       */<a name="line.286"></a>
<FONT color="green">287</FONT>      public Annotation getStartAnnotation(JCas jCas, Annotation annotation) {<a name="line.287"></a>
<FONT color="green">288</FONT>        return WindowFeature.getStartAnnotation(jCas, featureClass, annotation, orientation);<a name="line.288"></a>
<FONT color="green">289</FONT>      }<a name="line.289"></a>
<FONT color="green">290</FONT>    <a name="line.290"></a>
<FONT color="green">291</FONT>      public Class&lt;? extends Annotation&gt; getFeatureClass() {<a name="line.291"></a>
<FONT color="green">292</FONT>        return featureClass;<a name="line.292"></a>
<FONT color="green">293</FONT>      }<a name="line.293"></a>
<FONT color="green">294</FONT>    <a name="line.294"></a>
<FONT color="green">295</FONT>      public SimpleFeatureExtractor getFeatureExtractor() {<a name="line.295"></a>
<FONT color="green">296</FONT>        return featureExtractor;<a name="line.296"></a>
<FONT color="green">297</FONT>      }<a name="line.297"></a>
<FONT color="green">298</FONT>    <a name="line.298"></a>
<FONT color="green">299</FONT>      public String getName() {<a name="line.299"></a>
<FONT color="green">300</FONT>        return name;<a name="line.300"></a>
<FONT color="green">301</FONT>      }<a name="line.301"></a>
<FONT color="green">302</FONT>    <a name="line.302"></a>
<FONT color="green">303</FONT>      public int getEnd() {<a name="line.303"></a>
<FONT color="green">304</FONT>        return end;<a name="line.304"></a>
<FONT color="green">305</FONT>      }<a name="line.305"></a>
<FONT color="green">306</FONT>    <a name="line.306"></a>
<FONT color="green">307</FONT>      public String getOrientation() {<a name="line.307"></a>
<FONT color="green">308</FONT>        return orientation;<a name="line.308"></a>
<FONT color="green">309</FONT>      }<a name="line.309"></a>
<FONT color="green">310</FONT>    <a name="line.310"></a>
<FONT color="green">311</FONT>      public int getStart() {<a name="line.311"></a>
<FONT color="green">312</FONT>        return start;<a name="line.312"></a>
<FONT color="green">313</FONT>      }<a name="line.313"></a>
<FONT color="green">314</FONT>    <a name="line.314"></a>
<FONT color="green">315</FONT>    }<a name="line.315"></a>




























































</PRE>
</BODY>
</HTML>
